<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üéôÔ∏è –ê—É–¥—ñ–æ –≤ Telegram</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #2c3e50, #3498db);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }

    .card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }

    .status {
      margin: 20px 0;
      font-weight: bold;
      font-size: 18px;
    }

    .log {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 10px;
      max-height: 150px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 13px;
      text-align: left;
    }

    .controls button {
      margin: 10px;
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }

    .start {
      background-color: #2ecc71;
      color: white;
    }

    .start:hover {
      background-color: #27ae60;
    }

    .stop {
      background-color: #e74c3c;
      color: white;
    }

    .stop:hover {
      background-color: #c0392b;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üéôÔ∏è –ó–∞–ø–∏—Å –∞—É–¥—ñ–æ —ñ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤ Telegram</h1>
    <div class="status" id="status">–ì–æ—Ç–æ–≤–æ –¥–æ –∑–∞–ø–∏—Å—É</div>
    <div class="controls">
      <button class="start" id="startBtn">–°—Ç–∞—Ä—Ç</button>
      <button class="stop" id="stopBtn" disabled>–°—Ç–æ–ø</button>
    </div>
    <div class="log" id="log">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...
    </div>
  </div>

  <script>
    const BOT_TOKEN = "7559425067:AAEoI0api5HvyDGOulacrGcqNHAT0fqwHcE"; // <-- –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–≤—ñ–π —Ç–æ–∫–µ–Ω

    class AudioApp {
      constructor() {
        this.isRecording = false;
        this.mediaRecorder = null;
        this.init();
      }

      init() {
        this.startBtn = document.getElementById('startBtn');
        this.stopBtn = document.getElementById('stopBtn');
        this.status = document.getElementById('status');
        this.log = document.getElementById('log');

        this.startBtn.onclick = () => this.start();
        this.stopBtn.onclick = () => this.stop();
      }

      logMessage(msg) {
        const time = new Date().toLocaleTimeString('uk-UA');
        this.log.textContent += `\n[${time}] ${msg}`;
        this.log.scrollTop = this.log.scrollHeight;
      }

      async start() {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
          this.mediaRecorder = new MediaRecorder(stream);
          const chunks = [];

          this.mediaRecorder.ondataavailable = e => chunks.push(e.data);
          this.mediaRecorder.onstop = () => {
            const blob = new Blob(chunks, { type: 'audio/webm' });
            this.sendToTelegram(blob);
          };

          this.mediaRecorder.start();
          this.isRecording = true;
          this.status.textContent = 'üî¥ –ó–∞–ø–∏—Å –∞–∫—Ç–∏–≤–Ω–∏–π...';
          this.startBtn.disabled = true;
          this.stopBtn.disabled = false;
          this.logMessage('–°—Ç–∞—Ä—Ç –∑–∞–ø–∏—Å—É');
        } catch (err) {
          this.logMessage(`–ü–æ–º–∏–ª–∫–∞: ${err.message}`);
        }
      }

      stop() {
        this.mediaRecorder.stop();
        this.isRecording = false;
        this.status.textContent = '‚èπÔ∏è –ó–∞–ø–∏—Å –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
        this.startBtn.disabled = false;
        this.stopBtn.disabled = true;
        this.logMessage('–ó–∞–ø–∏—Å –∑—É–ø–∏–Ω–µ–Ω–æ');
      }

      async sendToTelegram(blob) {
        const formData = new FormData();
        formData.append('audio', blob, 'audio.webm');

        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendAudio`;

        try {
          const res = await fetch(url, {
            method: 'POST',
            body: formData
          });
          const json = await res.json();
          if (json.ok) {
            this.logMessage('‚úÖ –ê—É–¥—ñ–æ —É—Å–ø—ñ—à–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ');
          } else {
            this.logMessage(`‚ùå –ü–æ–º–∏–ª–∫–∞: ${json.description}`);
          }
        } catch (e) {
          this.logMessage(`‚ùå –ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ: ${e.message}`);
        }
      }
    }

    document.addEventListener('DOMContentLoaded', () => new AudioApp());
  </script>
</body>
</html>
